! Module that contains different permutations used for scrambling the Halton
! sequence.
!
! References:
!
!   [1] 'Good permutations for extreme discrepancy', Faure, Henri, Journal of
!       Number Theory, vol. 42, pages 47-56, 1992.
!
!   [2] Tuffin, Bruno, 'Simulation acceleree par les methodes de Monte Carlo
!       et quasi-Monte Carlo: theorie et applications', Ecole Doctorale de
!       Mathematiques de l'Ouest, Universite de Rennes, 1997, p. 46 and 49.
!
!   [3] 'An improved low-discrepancy sequence for multidimensional quasi-Monte
!       Carlo integration', Braaten, Eric and Weller, George, Journal of
!       Computational Physics, vol. 33, 1979, pages 249--258.
!
!   [4] `Good permutations for deterministic scrambled Halton sequences in
!       terms of L_2-discrepancy', Bart Vandewoestyne, Ronald Cools, Journal
!       of Computational and Applied Mathematics, Vol. 189, 2006,
!       pages 341-361.
!
! TODO:
!   * it would be more natural if permutations had indexes p(0:b-1) instead
!     of p(1:b).  Try to fit this in...

module mod_permutation

  use numeric_kinds
  use mod_primes

  private

  public :: init_permutations
  public :: init_perm_braaten_weller
  public :: init_perm_bw_extended
  public :: init_perm_faure
  public :: init_perm_mcl
  public :: init_perm_mcl_star
  public :: init_perm_reverse
  public :: free_permutation_table

  type, public :: permutation_pointer
    integer(kind=i4b), dimension(:), pointer :: p
  end type permutation_pointer


  contains


    function init_permutations(bases) result(permtable)
      integer(kind=i4b), dimension(:), intent(in)       :: bases
      type(permutation_pointer), dimension(size(bases)) :: permtable

      integer(kind=i4b) :: i, j

      do i=1,size(bases)
        allocate(permtable(i)%p(bases(i)))
        permtable(i)%p = (/ (j, j=0,bases(i)-1) /)
      end do

    end function init_permutations


    function init_perm_faure(n, onlyprimes) result(permtable)
      integer(kind=i4b), intent(in)           :: n
      logical, intent(in)                     :: onlyprimes
      type(permutation_pointer), dimension(n) :: permtable

      integer(kind=i4b)                                    :: b, max_base
      integer(kind=i4b)                                    :: i
      integer(kind=i4b)                                    :: k
      integer(kind=i4b), dimension(n)                      :: myprimes
      type(permutation_pointer), dimension(:), allocatable :: full_permtable


      ! Get the first n primes and the maximum base we'll ever use
      myprimes = primes(n)
      max_base = myprimes(n)

      ! Set up the local full permutation table, to be used as a local working
      ! copy. The number of permutations in this table is one less than the
      ! value of the maximum base we'll ever use.
      allocate(full_permtable(max_base-1))
      b = 2
      allocate(full_permtable(1)%p(2))
      full_permtable(1)%p = (/ 0, 1 /)
      do
        b = b + 1
        if (b > max_base) then
          exit
        end if
        allocate(full_permtable(b-1)%p(b))
        if (modulo(b, 2) == 0) then
          full_permtable(b-1)%p = (/ 2*full_permtable(b/2-1)%p,         &
                                     2*full_permtable(b/2-1)%p+1 /)
        else
          k = (b-1)/2
          full_permtable(b-1)%p = (/ full_permtable(b-2)%p(1:k),        &
                                       k, full_permtable(b-2)%p(k+1:b-1) /)
          where (full_permtable(b-1)%p >= k) 
            full_permtable(b-1)%p = full_permtable(b-1)%p + 1
          end where

          full_permtable(b-1)%p(k+1) = k
        end if
      end do

      ! Take only the prime bases should this be necessary
      if (onlyprimes) then

        ! Copy only the prime base permutations
        ! TODO:
        !   * Isn't this dangerous?   We are copying pointers to permutations
        !     here...
        permtable = full_permtable(myprimes-1) ! vector subscripts used here!

        ! Deallocate the non-primebase permutations because we don't need them
        ! anymore.  Note that we do keep the memory allocated by the primebase
        ! permutations because permtable now contains pointers to these memory
        ! locations!
        do i=1,size(full_permtable)
          if (all(myprimes /= i+1)) then
            deallocate(full_permtable(i)%p)
          end if 
        end do

      else

        ! Copy the n first permutations from the local work variable to the
        ! output variable...
        !permtable = full_permtable(1:n) ! QUESTION: why didn't this work???
        do i=1,n
          allocate(permtable(i)%p(i+1))
          permtable(i)%p = full_permtable(i)%p
        end do

        ! ... and clear the memory for all permutations from the
        ! local work variable.
        !call free_permutation_table(full_permtable) ! not allowed by F
        do i=1,size(full_permtable)
          if (associated(full_permtable(i)%p)) then
            deallocate(full_permtable(i)%p)
          end if
        end do

      end if

      ! Finally, do not forget to deallocate the local work-copy of the
      ! permutationtable (containing the pointers to the permutations) itself!
      deallocate(full_permtable)

    end function init_perm_faure


    ! See [3]
    function init_perm_braaten_weller(s) result(permtable)
      integer(kind=i4b), intent(in)           :: s
      type(permutation_pointer), dimension(s) :: permtable

      type(permutation_pointer), dimension(16) :: perm_data
      integer(kind=i4b) :: i

      do i=1,16
        allocate(perm_data(i)%p(allprimes(i)))
      end do

      perm_data(1)%p  = (/  0,  1/)
      perm_data(2)%p  = (/  0,  2,  1/)
      perm_data(3)%p  = (/  0,  3,  1,  4,  2/)
      perm_data(4)%p  = (/  0,  4,  2,  6,  1,  5,  3/)
      perm_data(5)%p  = (/  0,  5,  8,  2, 10,  3,  6,  1,  9,  7, &
                            4/)
      perm_data(6)%p  = (/  0,  6, 10,  2,  8,  4, 12,  1,  9,  5, &
                           11,  3,  7/)
      perm_data(7)%p  = (/  0,  8, 13,  3, 11,  5, 16,  1, 10,  7, &
                           14,  4, 12,  2, 15,  6,  9/)
      perm_data(8)%p  = (/  0,  9, 14,  3, 17,  6, 11,  1, 15,  7, &
                           12,  4, 18,  8,  2, 16, 10,  5, 13/)
      perm_data(9)%p  = (/  0, 11, 17,  4, 20,  7, 13,  2, 22,  9, &
                           15,  5, 18,  1, 14, 10, 21,  6, 16,  3, &
                           19,  8, 12/)
      perm_data(10)%p = (/  0, 15,  7, 24, 11, 20,  2, 27,  9, 18, &
                            4, 22, 13, 26,  5, 16, 10, 23,  1, 19, &
                           28,  6, 14, 17,  3, 25, 12,  8, 21/)
      perm_data(11)%p = (/  0, 15, 23,  5, 27,  9, 18,  2, 29, 12, &
                           20,  7, 25, 11, 17,  3, 30, 14, 22,  1, &
                           21,  8, 26, 10, 16, 28,  4, 19,  6, 24, &
                           13/)
      perm_data(12)%p = (/  0, 18, 28,  6, 23, 11, 34,  3, 25, 14, &
                           31,  8, 20, 36,  1, 16, 27, 10, 22, 13, &
                           32,  4, 29, 17,  7, 35, 19,  2, 26, 12, &
                           30,  9, 24, 15, 33,  5, 21/)
      perm_data(13)%p = (/  0, 20, 31,  7, 26, 12, 38,  3, 23, 34, &
                           14, 17, 29,  5, 40, 10, 24,  1, 35, 18, &
                           28,  9, 33, 15, 21,  4, 37, 13, 30,  8, &
                           39, 22,  2, 27, 16, 32, 11, 25,  6, 36, &
                           19/)
      perm_data(14)%p = (/  0, 21, 32,  7, 38, 13, 25,  3, 35, 17, &
                           28, 10, 41,  5, 23, 30, 15, 37,  1, 19, &
                           33, 11, 26, 42,  8, 18, 29,  4, 39, 14, &
                           22, 34,  6, 24, 12, 40,  2, 31, 20, 27, &
                            9, 36, 16/)
      perm_data(15)%p = (/  0, 24, 12, 39,  6, 33, 20, 44,  3, 29, &
                           16, 36, 10, 42, 22,  8, 31, 26, 14, 46, &
                            1, 35, 18, 28,  5, 40, 19, 37, 11, 25, &
                           43,  4, 30, 15, 34,  9, 45, 21,  2, 32, &
                           17, 41, 13, 27,  7, 38, 23/)
      perm_data(16)%p = (/  0, 26, 40,  9, 33, 16, 49,  4, 36, 21, &
                           45, 12, 29,  6, 51, 23, 38, 14, 43,  1, &
                           30, 19, 47, 10, 34, 24, 42,  3, 27, 52, &
                           15, 18, 39,  7, 46, 31, 11, 35, 20, 48, &
                            2, 28, 41,  8, 22, 50, 13, 32, 17, 44, &
                            5, 37, 25/)

      ! Copy the first s pointers
      ! The pointers in permtable now point to the same
      ! storage locations as the ones in perm_data!
      !permtable = perm_data(1:s)
      do i=1,s
        permtable(i) = perm_data(i)
      end do

      ! Deallocate the permutations we don't need anymore
      do i=s+1,16
        deallocate(perm_data(i)%p)
      end do
    
    end function init_perm_braaten_weller


    ! Initialize the permutations for the extended version of
    ! Braaten and Weller's permutation table. See [4].
    !
    function init_perm_bw_extended(s) result(permtable)
      integer(kind=i4b), intent(in)           :: s
      type(permutation_pointer), dimension(s) :: permtable

      type(permutation_pointer), dimension(64) :: perm_data
      integer(kind=i4b) :: i

      do i=1,64
        allocate(perm_data(i)%p(allprimes(i)))
      end do

      perm_data(1)%p  = (/    0,    1 /)
      perm_data(2)%p  = (/    0,    2,    1 /)
      perm_data(3)%p  = (/    0,    2,    4,    1,    3 /)
      perm_data(4)%p  = (/    0,    3,    5,    1,    6,    2,    4 /)
      perm_data(5)%p  = (/    0,    5,    8,    2,   10,    3,    6,    1, &
                               9,    4,    7 /)
      perm_data(6)%p  = (/    0,    6,   10,    2,    8,    4,   12,    1, &
                               9,    5,   11,    3,    7 /)
      perm_data(7)%p  = (/    0,    8,   13,    3,   11,    5,   16,    1, &
                              10,    7,   14,    4,   12,    2,   15,    6, &
                               9 /)
      perm_data(8)%p  = (/    0,    9,   14,    3,   17,    6,   11,    1, &
                              15,    7,   12,    4,   18,    8,    2,   16, &
                              10,    5,   13 /)
      perm_data(9)%p  = (/    0,   11,   17,    4,   20,    7,   13,    2, &
                              22,    9,   15,    5,   18,    1,   14,   10, &
                              21,    6,   16,    3,   19,    8,   12 /)
      perm_data(10)%p  = (/    0,   14,   22,    5,   18,    9,   27,    2, &
                              20,   11,   25,    7,   16,    3,   24,   13, &
                              19,    6,   28,   10,    1,   23,   15,   12, &
                              26,    4,   17,    8,   21 /)
      perm_data(11)%p  = (/    0,   16,    8,   26,    4,   22,   13,   29, &
                               2,   19,   11,   24,    6,   20,   14,   28, &
                               1,   17,    9,   30,   10,   23,    5,   21, &
                              15,    3,   27,   12,   25,    7,   18 /)
      perm_data(12)%p  = (/    0,   18,   28,    6,   23,   11,   34,    3, &
                              25,   14,   31,    8,   20,   36,    1,   16, &
                              27,   10,   22,   13,   32,    4,   29,   17, &
                               7,   35,   19,    2,   26,   12,   30,    9, &
                              24,   15,   33,    5,   21 /)
      perm_data(13)%p  = (/    0,   20,   31,    7,   26,   12,   38,    3, &
                              23,   34,   14,   17,   29,    5,   40,   10, &
                              24,    1,   35,   18,   28,    9,   33,   15, &
                              21,    4,   37,   13,   30,    8,   39,   19, &
                              25,    2,   32,   11,   22,   36,    6,   27, &
                              16 /)
      perm_data(14)%p  = (/    0,   21,   32,    7,   38,   13,   25,    3, &
                              35,   17,   28,   10,   41,    5,   23,   30, &
                              15,   37,    1,   19,   33,   11,   26,   42, &
                               8,   18,   29,    4,   39,   14,   22,   34, &
                               6,   24,   12,   40,    2,   31,   20,   16, &
                              36,    9,   27 /)
      perm_data(15)%p  = (/    0,   23,   35,    8,   41,   14,   27,    3, &
                              44,   18,   31,   11,   37,    5,   25,   39, &
                              16,   21,   33,    1,   46,   12,   29,   19, &
                              42,    7,   28,   10,   36,   22,    4,   43, &
                              17,   32,   13,   38,    2,   26,   45,   15, &
                              30,    6,   34,   20,   40,    9,   24 /)
      perm_data(16)%p  = (/    0,   26,   40,    9,   33,   16,   49,    4, &
                              36,   21,   45,   12,   29,    6,   51,   23, &
                              38,   14,   43,    1,   30,   19,   47,   10, &
                              34,   24,   42,    3,   27,   52,   15,   18, &
                              39,    7,   46,   22,   32,    5,   48,   13, &
                              35,   25,    8,   44,   31,   17,   50,    2, &
                              37,   20,   28,   11,   41 /)
      perm_data(17)%p  = (/    0,   29,   44,   10,   52,   18,   34,    4, &
                              48,   23,   38,   13,   57,    7,   32,   41, &
                              20,   54,    2,   26,   46,   15,   36,   24, &
                              50,    8,   40,   16,   56,    5,   30,   43, &
                              21,   51,   11,   33,    1,   58,   27,   37, &
                              14,   47,   19,   28,   45,    6,   53,   12, &
                              35,   22,   42,    3,   55,   25,   31,    9, &
                              49,   17,   39 /)
      perm_data(18)%p  = (/    0,   30,   46,   10,   38,   18,   56,    4, &
                              42,   24,   52,   14,   33,   21,   59,    6, &
                              40,   27,   49,    2,   35,   16,   54,   12, &
                              44,   26,   50,    8,   32,   58,   19,    1, &
                              41,   29,   48,   13,   36,   22,   60,    7, &
                              45,   23,   53,    9,   34,   17,   55,    3, &
                              39,   28,   47,   15,   37,   20,   57,    5, &
                              43,   25,   51,   11,   31 /)
      perm_data(19)%p  = (/    0,   33,   50,   11,   59,   20,   39,    5, &
                              54,   26,   44,   15,   64,   23,   36,    2, &
                              57,   30,   47,    9,   62,   18,   41,   13, &
                              52,   28,   37,    4,   66,   24,   46,    8, &
                              55,   31,   17,   60,   34,    1,   48,   21, &
                              43,   63,   12,   29,   51,    7,   40,   25, &
                              58,   16,   45,    6,   65,   35,   19,   53, &
                              10,   38,   56,   22,   32,    3,   61,   42, &
                              14,   49,   27 /)
      perm_data(20)%p  = (/    0,   35,   53,   12,   62,   21,   41,    5, &
                              67,   28,   46,   16,   56,   25,    8,   50, &
                              38,   65,    2,   32,   59,   19,   44,   14, &
                              70,   30,   48,    7,   39,   58,   22,   10, &
                              63,   33,   26,   52,    1,   55,   18,   43, &
                              68,   13,   36,   47,    4,   61,   24,   31, &
                              66,   15,   42,   27,   54,    6,   49,   20, &
                              69,    9,   40,   57,   29,    3,   60,   37, &
                              17,   51,   34,   11,   64,   23,   45 /)
      perm_data(21)%p  = (/    0,   37,   18,   61,   27,   51,    6,   68, &
                              32,   12,   55,   43,   21,   65,    3,   46, &
                              30,   58,   14,   40,   71,    9,   35,   49, &
                              23,   63,    1,   53,   25,   42,   16,   69, &
                              10,   48,   33,   59,   19,   38,    5,   66, &
                              28,   56,   13,   45,   72,    7,   34,   52, &
                              22,   62,    2,   41,   26,   60,   17,   47, &
                              29,   70,    8,   39,   54,   15,   64,   24, &
                              36,    4,   57,   44,   20,   67,   11,   50, &
                              31 /)
      perm_data(22)%p  = (/    0,   40,   20,   66,   10,   55,   33,   73, &
                               5,   48,   28,   61,   16,   70,   37,   24, &
                              52,    2,   77,   44,   14,   58,   31,   64, &
                               8,   46,   26,   75,   18,   50,   36,   62, &
                               4,   42,   69,   12,   30,   57,   22,   72, &
                               7,   53,   39,   23,   78,   15,   49,   34, &
                              65,    1,   59,   27,   45,   11,   68,   41, &
                              19,   74,   32,   54,    6,   63,   21,   47, &
                              35,   76,    3,   56,   17,   67,   29,   43, &
                               9,   60,   25,   71,   13,   51,   38 /)
      perm_data(23)%p  = (/    0,   41,   62,   14,   73,   25,   48,    6, &
                              67,   32,   54,   19,   80,   10,   44,   58, &
                              29,   76,    2,   37,   64,   22,   51,   16, &
                              71,   35,   56,    8,   82,   27,   46,   12, &
                              69,   39,   60,    4,   50,   24,   78,   31, &
                              65,   17,   42,   74,    1,   53,   21,   61, &
                              34,   11,   79,   40,   47,    7,   70,   28, &
                              57,   18,   75,   33,   49,    5,   66,   23, &
                              81,   38,   13,   55,   43,   15,   68,   30, &
                              63,    3,   77,   26,   52,   36,    9,   72, &
                              45,   20,   59 /)
      perm_data(24)%p  = (/    0,   44,   67,   15,   56,   27,   82,    6, &
                              50,   74,   22,   36,   63,   10,   86,   33, &
                              53,   18,   77,   40,    2,   70,   47,   29, &
                              80,   12,   60,   38,   65,   20,   88,    4, &
                              51,   31,   72,   24,   58,    8,   78,   42, &
                              46,   16,   84,   34,   62,    1,   69,   26, &
                              55,   19,   76,   41,   11,   83,   49,   30, &
                              66,    7,   59,   37,   87,   14,   54,   25, &
                              73,   21,   68,   43,    3,   79,   35,   57, &
                              13,   81,   45,   28,   64,    5,   75,   32, &
                              52,   17,   85,   39,    9,   61,   71,   23, &
                              48 /)
      perm_data(25)%p  = (/    0,   48,   73,   16,   61,   29,   89,    7, &
                              55,   81,   34,   22,   69,   41,   94,    3, &
                              52,   77,   19,   38,   85,   12,   64,   44, &
                              26,   91,   58,    9,   71,   32,   79,   14, &
                              50,   66,   24,   96,    1,   46,   83,   36, &
                              59,   18,   75,   30,   87,    5,   54,   42, &
                              68,   21,   92,   10,   62,   39,   80,   27, &
                              56,    6,   86,   47,   72,   15,   35,   93, &
                              43,   65,    2,   76,   25,   53,   84,   17, &
                              37,   67,   11,   90,   49,   31,   74,   20, &
                              60,   95,    4,   45,   63,   28,   82,   13, &
                              57,   40,   78,    8,   88,   33,   51,   23, &
                              70 /)
      perm_data(26)%p  = (/    0,   50,   76,   17,   63,   30,   93,    7, &
                              69,   39,   86,   23,   55,   12,   97,   44, &
                              73,   27,   59,    3,   83,   36,   90,   20, &
                              53,   79,   10,   65,   41,   99,   32,   47, &
                               5,   81,   61,   25,   88,   15,   70,   45, &
                              34,   95,    1,   67,   52,   21,   85,   38, &
                              75,   13,   92,   49,   28,   60,    8,  100, &
                              57,   19,   77,   42,   72,    4,   87,   33, &
                              56,   24,   82,   37,   66,   11,   96,   46, &
                              16,   78,   62,   29,   91,    2,   51,   71, &
                              22,   98,   40,   14,   68,   54,   84,    9, &
                              43,   89,   31,   64,   18,   80,   35,   58, &
                               6,   94,   48,   26,   74 /)
      perm_data(27)%p  = (/    0,   51,   77,   17,   90,   31,   60,    7, &
                              97,   40,   67,   23,   82,   36,   55,    3, &
                              93,   45,   72,   14,   85,   27,   63,   20, &
                             101,   47,   10,   74,   57,   34,   88,    5, &
                              69,   42,   95,   25,   53,   79,   12,   65, &
                              30,   99,   18,   49,   81,    1,   71,   38, &
                              91,   28,   59,   43,   86,    9,   62,   22, &
                             102,   37,   75,   13,   54,   84,    4,   68, &
                              46,   96,   24,   33,   78,   50,   15,   92, &
                              58,    8,   73,   39,   98,   21,   64,   32, &
                              83,    2,   56,   89,   29,   48,   76,   16, &
                             100,   41,   11,   66,   80,   26,   52,   94, &
                               6,   61,   35,   87,   19,   70,   44 /)
      perm_data(28)%p  = (/    0,   54,   27,   89,   13,   75,   45,   99, &
                              20,   65,   37,   83,    4,   70,  103,   32, &
                              50,    9,   92,   59,   40,   79,   17,   95, &
                              25,   62,   47,   85,    2,   72,   34,  105, &
                              15,   57,   77,   23,   97,   42,    7,   67, &
                              52,   87,   29,   81,   11,   61,  101,   35, &
                              21,   69,   48,   93,    5,   56,   90,   30, &
                              43,  106,   12,   73,   38,   78,    1,   64, &
                              96,   24,   51,   84,   18,   58,   33,  100, &
                               8,   74,   44,   88,   19,   66,   39,  102, &
                              14,   55,   80,   28,   68,    3,   94,   46, &
                              31,   86,   53,   10,  104,   63,   22,   76, &
                              36,   91,    6,   60,   41,   98,   16,   71, &
                              49,   82,   26 /)
      perm_data(29)%p  = (/    0,   54,   82,   18,   68,   33,  100,    8, &
                              75,   42,   93,   25,   59,   13,  105,   47, &
                              72,   29,   88,    3,   63,   39,   97,   21, &
                              79,   50,   10,  103,   56,   36,   85,   16, &
                              70,   45,   91,    5,  107,   31,   65,   52, &
                              23,   86,   38,   77,    1,   96,   60,   27, &
                              81,   14,  101,   44,   62,   20,   90,   49, &
                               7,   74,  108,   34,   57,   26,   84,   11, &
                              69,   95,   40,   53,    4,   99,   66,   30, &
                              78,   17,   92,   43,   61,   12,  104,   35, &
                              73,   22,   87,   48,    2,  102,   55,   32, &
                              80,   19,   71,   94,   41,    9,   67,  106, &
                              28,   51,   83,    6,   64,   46,   98,   24, &
                              76,   15,   89,   37,   58 /)
      perm_data(30)%p  = (/    0,   56,   85,   19,   71,   34,  104,    8, &
                              64,   94,   28,   46,   80,   13,  109,   41, &
                              60,    3,   97,   51,   76,   24,   90,   37, &
                             101,   16,   67,   48,   83,    6,  111,   31, &
                              62,   43,   88,   21,   74,   11,  106,   54, &
                              32,   92,   26,   70,   78,    1,   99,   44, &
                              58,   17,  107,   39,   81,   10,   66,   96, &
                              29,   53,   87,    5,  103,   49,   36,   73, &
                              22,  112,   59,   14,   84,   40,   69,   20, &
                              98,   52,    4,   91,   63,   33,  105,   25, &
                              77,   47,   89,    9,   68,   38,  110,   15, &
                              79,   55,   27,   95,    2,   75,   45,  102, &
                              23,   61,   86,   12,   65,  108,   35,   50, &
                               7,   93,   57,   82,   30,  100,   18,   72, &
                              42 /)
      perm_data(31)%p  = (/    0,   63,   95,   21,  111,   38,   74,    9, &
                             119,   49,   83,   29,  101,   15,   68,   55, &
                             123,   34,   88,    3,  105,   45,   78,   25, &
                             114,   58,   12,   92,   70,   42,  108,   18, &
                              85,   52,  125,    5,   65,   98,   32,   80, &
                              40,  116,   23,   61,  102,    7,   90,   47, &
                              75,   27,  121,   54,   13,  107,   72,   36, &
                              96,    1,  113,   59,   43,   86,   19,  118, &
                              66,   30,   93,   10,  104,   51,   79,   33, &
                             126,   17,   76,   57,   99,    4,  110,   46, &
                              69,   26,   89,  120,   22,   62,   39,  100, &
                               8,   82,  115,   48,   35,   84,   14,  109, &
                              64,   53,   94,    2,  124,   31,   73,   44, &
                             103,   20,   81,   60,  117,   11,   71,   37, &
                              97,   24,  112,   56,   87,    6,  122,   41, &
                              67,   28,   91,   50,  106,   16,   77 /)
      perm_data(32)%p  = (/    0,   65,   98,   22,  115,   39,   76,    9, &
                             106,   51,   85,   30,  126,   15,   70,   92, &
                              45,  119,    4,   59,   88,   34,  110,   54, &
                              19,  123,   73,   27,  101,   47,   81,    6, &
                             129,   62,   37,   95,   13,  108,   67,   42, &
                             113,   24,   83,   56,  103,    1,   78,  121, &
                              31,   49,   90,   17,  117,   61,   11,   96, &
                              71,   36,  128,   26,   80,   53,  105,    7, &
                              93,   43,  124,   21,   68,   86,   33,  112, &
                               3,   74,   58,  118,   41,  100,   16,   64, &
                             109,   28,   84,   48,  130,   10,   77,   52, &
                              99,   20,  114,   38,   89,    5,   69,  122, &
                              46,   60,  102,   14,   91,   29,  125,   55, &
                              23,   79,  107,    2,   72,   97,   40,  120, &
                              32,   63,   82,   12,  111,   50,   87,   18, &
                             127,   44,   66,   25,  104,   75,    8,  116, &
                              57,   35,   94 /)
      perm_data(33)%p  = (/    0,   68,  103,   23,   86,   41,  126,   10, &
                              77,  114,   48,   31,   97,   58,  132,    5, &
                              81,   36,  118,   54,   17,  108,   72,   92, &
                              20,  129,   45,   63,  100,    2,  121,   29, &
                              83,   60,  111,   14,   89,   39,  135,   51, &
                              70,   12,  106,   33,  123,   75,   25,   95, &
                              56,  116,    7,   79,   43,  131,   27,   93, &
                              65,   16,  112,   52,  102,    3,  125,   66, &
                              37,   87,   47,  134,   21,   98,   73,    9, &
                             109,   61,   34,  120,   82,   24,   90,   49, &
                             128,    6,   76,  105,   40,   59,  117,   18, &
                              94,   30,  136,   55,   69,    1,  110,   84, &
                              28,  122,   44,   78,   13,  101,   64,  127, &
                              19,   88,   42,  113,   11,   71,  104,   35, &
                             130,   53,   26,   96,   62,    4,  119,   80, &
                              46,  107,   22,   85,  133,   38,   57,    8, &
                             115,   74,   91,   32,  124,   15,   67,   99, &
                              50 /)
      perm_data(34)%p  = (/    0,   69,  104,   23,  122,   42,   81,   10, &
                             113,   54,   90,   32,  133,   16,   74,   97, &
                              48,  127,    4,   62,  108,   36,   85,   27, &
                             136,   58,   94,   13,  117,   46,   76,   20, &
                             119,   65,  100,    2,   83,   39,  130,   52, &
                             106,   29,   71,  124,    8,   88,   44,  111, &
                              25,   67,  138,   18,   92,   56,  102,   34, &
                              78,    6,  128,   60,  115,   38,   80,   14, &
                             121,   50,   96,   22,  109,   63,   31,  134, &
                              72,    1,   99,   51,  125,   41,   86,   11, &
                             112,   66,   28,  131,   77,   17,   93,   55, &
                             105,   35,  118,    7,   84,   59,  137,   43, &
                              73,   21,  114,   47,   98,    5,  126,   68, &
                              30,   91,  103,   15,  132,   53,   79,   26, &
                             110,   40,   87,    9,  123,   61,   70,   37, &
                             135,    3,   95,   57,  116,   24,   82,  101, &
                              45,   19,  129,   64,   89,   12,  120,   49, &
                              75,  107,   33 /)
      perm_data(35)%p  = (/    0,   74,  112,   25,   93,   45,  137,   11, &
                             102,   58,  127,   34,   81,   17,  144,   65, &
                             107,   39,   87,    4,  123,   53,  132,   29, &
                              78,  116,   20,   97,   61,  141,    7,   70, &
                             119,   47,   90,   36,  147,   14,  100,   55, &
                             110,   42,  129,    2,   83,   68,  134,   27, &
                              95,   50,  121,   22,   76,  139,   32,   85, &
                              63,  114,    9,  105,   43,  145,   16,   72, &
                             104,   52,  125,    6,   89,   59,  135,   30, &
                              98,   38,  118,   67,   19,  142,   79,   12, &
                             109,   49,  130,   57,   91,   24,  124,    1, &
                              82,  148,   41,   73,  103,   33,  115,   21, &
                              94,   62,  136,   10,   75,  120,   46,   86, &
                              28,  140,   54,  108,    5,  128,   66,   37, &
                              99,   48,  133,   15,   88,  113,   26,   71, &
                             146,   40,   80,    3,  122,   60,  101,   23, &
                             131,   64,   92,   13,  117,   51,  143,   35, &
                              84,   69,  111,    8,  126,   44,   96,   18, &
                             138,   56,   77,   31,  106 /)
      perm_data(36)%p  = (/    0,   75,  113,   25,  132,   45,   88,   11, &
                             142,   59,   98,   34,  120,   52,   81,    5, &
                             137,   67,  105,   20,  125,   40,   93,   30, &
                             148,   63,   84,   14,  116,   55,  108,    2, &
                             134,   71,   38,  101,   48,  145,   18,   91, &
                             123,   28,   77,  111,    9,  129,   61,   50, &
                              96,  140,   23,   73,   42,  118,    7,  150, &
                              80,   57,  103,   32,  127,   16,   86,   68, &
                             136,   36,  100,    3,  114,   65,   46,  144, &
                              26,   94,   83,  122,   13,   54,  131,   43, &
                             107,   70,   21,  146,   78,   31,  110,    6, &
                             126,   62,   90,   39,  139,   51,   97,   15, &
                             117,   74,   24,  141,   87,    1,  106,   58, &
                             130,   35,   79,  119,   19,   66,  149,   47, &
                              99,   10,  112,   53,  135,   29,   89,   69, &
                             124,    8,   85,   41,  143,   56,  104,   22, &
                             115,   37,   95,   72,  138,    4,   60,  128, &
                              27,   92,   49,  147,   17,  102,   76,   44, &
                             121,   12,  133,   64,   82,   33,  109 /)
      perm_data(37)%p  = (/    0,   78,  118,   26,   98,   47,  144,   11, &
                             108,   61,  133,   36,   85,   18,  151,   68, &
                             103,   42,  126,    4,   90,  138,   54,   31, &
                             114,   72,  148,   15,   81,   57,  123,   23, &
                             105,   50,  155,    7,   94,  129,   39,   74, &
                             112,   29,  140,   64,    2,   96,  135,   45, &
                              87,   59,  121,   20,  146,   70,   33,  110, &
                              13,  131,   83,   52,  153,   24,  100,   76, &
                              40,  120,    8,  142,   66,   92,   35,  127, &
                              56,  106,    5,  150,   80,   44,  116,   17, &
                             136,   63,   89,   27,  124,   73,  101,   10, &
                             156,   49,   95,   32,  139,   60,  111,    1, &
                              86,  145,   38,   69,  117,   21,  130,   51, &
                              99,   14,  149,   77,   43,  109,   25,  132, &
                              65,   91,    9,  141,   55,  104,   30,  122, &
                              79,   19,  154,   48,   93,  115,    3,   71, &
                             137,   37,   84,  125,   22,  102,   58,  147, &
                              12,   75,  119,   41,  134,   53,   88,    6, &
                             152,   62,  107,   28,  113,   46,  143,   16, &
                              82,   97,   34,  128,   67 /)
      perm_data(38)%p  = (/    0,   81,  122,   27,  143,   49,   95,   12, &
                             132,   63,  106,   37,  156,   19,   87,  114, &
                              56,  149,    5,   73,  126,   43,  100,   67, &
                             160,   23,   91,   33,  137,   59,  117,    8, &
                             140,   77,   46,  109,   16,  152,   84,   40, &
                             128,   70,  103,    2,  146,   53,  112,   29, &
                             134,   65,   93,   21,  158,   51,   98,   10, &
                             124,   79,  148,   35,   75,  119,   14,  138, &
                              45,   89,   61,  162,   25,  107,   31,  130, &
                              71,  102,    3,  153,   55,  115,   39,   86, &
                             142,   17,   96,   58,  131,    7,  120,   68, &
                             155,   32,   82,   47,  111,  145,   13,   90, &
                              42,  135,   74,   24,  123,  101,    1,  159, &
                              62,   80,  116,   28,  150,   50,   97,   20, &
                             139,   57,  108,   36,  127,    9,   85,  154, &
                              66,   41,  121,   76,   15,  144,   94,   52, &
                             133,    6,  105,   69,  161,   30,  110,   44, &
                              88,  141,   22,   78,  125,   11,  151,   54, &
                              99,   34,  118,   64,  147,    4,   83,  104, &
                              38,  136,   48,  113,   18,  157,   72,   60, &
                             129,   26,   92 /)
      perm_data(39)%p  = (/    0,   83,  125,   28,  146,   50,   97,   12, &
                             157,   65,  109,   38,  132,   19,   89,  117, &
                              57,  162,    5,   75,  138,   44,  102,   69, &
                             150,   23,  112,   34,  128,   60,   92,    8, &
                             154,   78,   47,  141,   16,  120,   86,   54, &
                             165,   31,  105,   72,  135,    2,  114,   41, &
                             148,   63,   95,   21,  130,   80,   26,  159, &
                             100,   42,  122,   10,  143,   67,   88,   52, &
                             153,   14,  108,   74,  136,   33,  116,    4, &
                             164,   58,   94,   37,  126,   81,   25,  145, &
                              62,  106,   17,  156,   49,  119,   84,    7, &
                             139,   70,  103,   39,  161,   46,  123,   22, &
                              98,  133,   55,   77,  151,    1,   91,   30, &
                             142,   66,  111,   15,  166,   53,  113,   35, &
                             129,   82,   11,  149,   71,   99,   43,  134, &
                              27,  107,  158,   59,    6,   93,  124,   48, &
                             144,   29,   87,  118,   64,   18,  160,   76, &
                             104,   36,  140,    9,  127,   68,   90,  155, &
                              24,   56,  115,   45,  152,    3,  101,   79, &
                             137,   40,  110,   20,  163,   73,   61,  131, &
                              13,   96,  147,   32,   85,  121,   51 /)
      perm_data(40)%p  = (/    0,   86,  130,   29,  108,   52,  159,   12, &
                             119,   67,  147,   39,   94,   20,  167,   75, &
                             114,   46,  139,    5,   99,  152,   59,   79, &
                              25,  135,   63,  163,   34,  104,  124,    8, &
                              89,  144,   43,   72,  171,   16,  112,   55, &
                             128,   32,  154,   82,    2,  121,   96,   50, &
                             157,   69,   22,  141,  101,   41,  133,   77, &
                              14,  165,   91,   57,  117,   27,  149,   65, &
                             109,    7,  169,   48,  126,   84,   36,  143, &
                              18,  105,  137,   61,   88,  161,    3,   73, &
                             116,   37,  151,   45,   98,  131,   23,   81, &
                             172,   11,  111,   58,  146,   31,   93,  123, &
                              53,  156,   15,   76,  134,   66,  103,   26, &
                             164,   42,  120,    1,  140,   85,   70,  158, &
                              33,  106,   51,  127,   10,  168,   90,   62, &
                             113,   21,  148,   47,   97,  138,   17,   80, &
                             155,   38,  102,   68,  129,    6,  162,   56, &
                             115,   30,  145,   74,   92,   13,  170,   49, &
                             122,   83,   28,  136,   60,  110,    4,  153, &
                              95,   40,  160,   71,   24,  125,  100,   44, &
                             142,   64,  118,    9,  166,   78,   35,  132, &
                              87,   19,  150,   54,  107 /)
      perm_data(41)%p  = (/    0,   89,  134,   30,  157,   54,  104,   13, &
                             145,   70,  116,   41,  172,   21,   96,  125, &
                              62,  163,    5,   80,  139,   47,  110,   35, &
                             168,   75,  120,   17,  150,   59,   92,   26, &
                             176,   84,  129,    8,  107,   51,  153,   67, &
                             136,   33,  100,  160,    2,   78,  123,   44, &
                             166,   57,  113,   23,  143,   86,   38,  148, &
                              72,   11,  174,  102,   64,  131,   19,  118, &
                              94,   45,  161,   28,  141,   82,    6,  170, &
                              98,   53,  127,   66,  154,   15,  111,   40, &
                             147,   76,  106,   31,  178,   49,  122,    3, &
                             137,   87,   61,  158,   24,  115,   73,  165, &
                              36,   95,  132,   10,  151,   56,   90,  126, &
                              18,  173,   68,   43,  109,  142,   14,   99, &
                             164,   50,   81,  119,   27,  155,   60,    1, &
                             135,   88,  177,   37,  103,   71,  144,   22, &
                             114,   48,  159,   77,    9,  130,   93,  169, &
                              32,   65,  124,   42,  149,   12,  108,   83, &
                             171,   55,  117,   25,  140,   69,  101,    4, &
                             156,   52,  133,   79,   34,  175,   97,   20, &
                             146,   63,  121,   39,  162,   85,    7,  128, &
                             105,   46,  167,   29,   91,  138,   58,  112, &
                              16,  152,   74 /)
      perm_data(42)%p  = (/    0,   90,  136,   30,  113,   54,  166,   13, &
                             124,   70,  154,   41,   98,   63,  175,    6, &
                             130,   80,   35,  148,  104,   22,  160,   75, &
                              49,  141,   94,   17,  171,  109,   45,  120, &
                               3,  151,   67,   85,  178,   27,  117,   58, &
                             133,   38,  144,   78,   10,  163,  100,   52, &
                             126,   24,  157,   87,   61,  111,   15,  173, &
                              73,  138,   33,  106,   47,  168,   92,    1, &
                             146,   65,  122,   20,  158,   83,   43,  131, &
                             102,   29,  180,   57,  116,    8,  150,   81, &
                              96,  140,   36,  165,   18,   71,  127,   55, &
                             170,   11,  108,   89,  135,   40,  155,   60, &
                              76,  118,    5,  176,   48,  103,  143,   25, &
                              93,  161,   32,   69,  128,   14,  152,   84, &
                             114,   44,  174,   23,   99,   64,  139,   51, &
                             123,    2,  164,   77,  110,   34,  147,   66, &
                             179,   19,   97,  132,   39,   88,  156,    9, &
                             119,   56,  167,   72,   28,  134,  105,   50, &
                             149,    7,  112,   82,  172,   37,   91,  142, &
                              16,  125,   62,  162,   46,   79,  115,    4, &
                             177,   68,  129,   26,  101,  153,   42,   86, &
                             145,   21,  107,   59,  169,   12,  121,   74, &
                             159,   31,   95,  137,   53 /)
      perm_data(43)%p  = (/    0,   95,  143,   32,  167,   57,  111,   14, &
                             179,   74,  124,   43,  151,   66,  102,    6, &
                             185,   84,  133,   25,  158,   50,  117,   79, &
                             171,   19,  129,   39,  147,   63,   99,  176, &
                               3,   90,  138,   35,  162,   54,  108,   71, &
                             189,   12,  121,   87,  154,   28,  114,   47, &
                             173,   21,  136,   77,  105,  164,    9,   61, &
                             145,   92,   41,  183,   68,  127,   23,  156, &
                              82,  119,    1,  181,   52,  131,   37,  149, &
                              97,   59,  169,   17,  109,   86,  187,   30, &
                             140,   70,  115,   10,  160,   48,  125,   76, &
                             175,   33,  101,  142,   16,  165,   56,   93, &
                             134,   44,  190,    5,  106,   80,  153,   27, &
                             122,   65,  177,   46,  112,   88,  159,    8, &
                             139,   60,  170,   24,   98,   73,  148,   36, &
                             184,   53,  118,   13,  130,   91,  163,   40, &
                             104,  152,   20,   78,  180,   64,  126,    2, &
                             144,   69,  110,   31,  186,   83,  135,   26, &
                             168,   51,  100,  155,   11,  116,   58,  174, &
                              42,   94,  137,   18,  178,   75,  120,   38, &
                             150,   67,  103,    4,  188,   85,  132,   29, &
                             161,   49,  113,   81,  166,   15,  128,   55, &
                             146,   34,  182,   89,    7,  123,   72,  157, &
                              45,  107,  172,   22,   96,  141,   62 /)
      perm_data(44)%p  = (/    0,   96,  145,   32,  121,   58,  177,   14, &
                             109,  161,   48,   79,  137,   22,  186,   71, &
                             103,   40,  155,   86,    5,  170,  127,   63, &
                             133,   27,  182,   75,  114,   10,  151,   53, &
                             166,   91,   37,  141,   99,   18,  190,   67, &
                             118,   45,  159,   83,    2,  174,  111,   55, &
                             131,   30,  149,   89,  180,   20,  105,   65, &
                             164,   42,  125,   77,  188,    8,  135,   51, &
                             116,   94,  154,   24,  172,   35,   81,  143, &
                              60,  123,   12,  184,   72,  107,   28,  162, &
                              98,   46,  147,    3,  176,   87,  129,   57, &
                             139,   16,  192,   69,  102,   38,  157,  113, &
                              25,  168,   74,  120,    7,  150,   61,  179, &
                              49,   93,  132,   33,  167,   84,   15,  140, &
                             106,   52,  187,   78,  124,    1,  158,   43, &
                             110,  173,   31,   92,  144,   64,   19,  183, &
                             100,   68,  136,   11,  153,   82,  119,   41, &
                             191,   54,  128,   23,  165,   88,  112,   36, &
                             171,    6,  146,   73,  101,  178,   47,  122, &
                              21,  152,   62,   95,  160,   13,  130,   66, &
                             185,   39,  108,   80,  142,    4,  175,   56, &
                             117,   29,  163,   85,  134,   44,  189,   26, &
                              97,   76,  148,    9,  126,   70,  169,   50, &
                             115,  156,   17,  104,  181,   34,   90,  138, &
                              59 /)
      perm_data(45)%p  = (/    0,   99,   49,  164,   74,  138,   16,  183, &
                              62,  120,   30,  152,   90,  174,    7,  112, &
                              55,  145,   82,  192,   25,  127,   40,  158, &
                              94,   12,  178,   69,  116,   44,  135,  105, &
                             188,   21,   78,  149,   36,  168,   65,  124, &
                               2,  161,   87,  108,   51,  195,   28,  132, &
                              72,  171,   10,  102,  142,   58,  181,   34, &
                             118,   85,  155,   18,  130,   60,  186,   42, &
                              97,  147,    4,  166,   80,  110,   46,  176, &
                              23,  125,   92,  154,   53,  191,   14,  103, &
                              68,  140,   32,  170,   76,  122,    6,  185, &
                              88,  136,   38,  114,   57,  160,   26,  194, &
                              71,  107,  144,    9,  151,   48,   96,  175, &
                              35,  129,   66,  163,   19,  100,  180,   63, &
                              84,  133,    1,  189,   45,  117,   81,  156, &
                              22,  141,   93,   52,  172,   29,  121,  196, &
                              13,  109,   75,  148,   56,  165,   39,  113, &
                              89,  179,    5,  134,   64,  157,   31,  104, &
                             184,   17,  126,   77,  143,   43,  169,   61, &
                              98,   11,  190,   86,  128,   37,  150,   70, &
                             115,   24,  177,   50,  159,   95,    3,  139, &
                             106,  193,   47,   79,  137,   20,  167,   67, &
                             119,   33,  182,   83,  123,    8,  153,   59, &
                             173,   41,  101,  146,   15,  111,  187,   54, &
                              91,  131,   27,  162,   73 /)
      perm_data(46)%p  = (/    0,   99,  149,   33,  174,   60,  116,   14, &
                             187,   77,  129,   45,  158,   23,  107,  139, &
                              68,  193,    6,   89,  164,   52,  122,   82, &
                             178,   28,  134,   41,  103,  168,   10,  144, &
                              72,   93,  196,   37,  119,   56,  154,   18, &
                             182,   85,  111,    2,  161,   64,  136,   49, &
                             184,   95,   26,  146,   75,  126,   35,  172, &
                             105,   12,  190,   66,  131,   54,  156,   21, &
                             113,  170,   80,   43,  142,   91,  198,    4, &
                             109,   59,  165,   31,  124,  151,   70,   16, &
                             180,   97,   47,  140,   86,  188,    8,  118, &
                              62,  160,   39,  176,  101,   25,  132,   79, &
                             192,   50,  121,   19,  152,   88,  167,    1, &
                             110,   73,  183,   40,  137,   58,  147,   30, &
                             115,  195,   69,   96,   13,  162,  127,   46, &
                             175,   83,   22,  143,  102,   55,  186,    7, &
                             130,   92,  157,   34,  171,   65,  106,   29, &
                             191,   76,  125,   11,  150,   84,  177,   44, &
                             114,   53,  155,   17,  135,   98,  197,   36, &
                              74,  145,    3,  169,   90,  120,   61,  181, &
                              24,  112,   67,  163,   42,  138,  100,    9, &
                             189,   78,  148,   48,  128,   27,  179,   87, &
                             117,   15,  166,   63,  153,   51,  108,  194, &
                               5,   94,  133,   38,  173,   71,  123,   32, &
                             185,   81,  141,   20,  104,  159,   57 /)
      perm_data(47)%p  = (/    0,  106,   53,  176,   26,  148,   88,  196, &
                              40,  129,   74,  163,    9,  138,   98,  204, &
                              33,  118,   64,  183,   16,  156,   82,  124, &
                              48,  190,   69,  168,    4,  142,  102,  208, &
                              30,  112,   59,  172,   85,   20,  153,  133, &
                              45,  193,   93,   12,  180,  115,   67,  159, &
                              37,  200,   78,  126,    6,  145,   96,  186, &
                              51,  109,   24,  170,   72,  206,   56,  136, &
                              18,  151,  104,  178,   42,  121,   80,  198, &
                               1,  140,   61,  165,   35,  116,  188,   89, &
                              28,  158,   76,  131,   14,  210,   94,   55, &
                             174,  110,   43,  150,   22,  192,  100,  134, &
                              63,  182,    8,  123,   83,  162,   38,  202, &
                              66,  144,   11,  167,   91,   49,  195,  107, &
                              31,  147,  119,   71,  185,    3,  128,   58, &
                             203,   86,  155,   25,  113,  173,   46,   99, &
                             161,   17,  189,   75,  132,   34,  141,   60, &
                             207,   13,  103,  177,   79,  122,   41,  166, &
                              52,  197,   92,    5,  149,  114,   68,  181, &
                              23,  137,   87,  201,   29,  154,   54,  127, &
                              97,  171,    7,  187,   70,  108,   36,  160, &
                              81,  209,   19,  135,   47,  146,  105,  179, &
                              15,  120,   62,  194,   44,  143,   84,  169, &
                               2,  117,  199,   57,   95,   32,  157,  130, &
                              73,  184,   21,  111,  205,   39,   90,  152, &
                              10,  175,   77,  139,   50,  191,   65,  125, &
                              27,  164,  101 /)
      perm_data(48)%p  = (/    0,  111,  167,   37,  195,   67,  130,   16, &
                             209,   87,  145,   51,  177,   26,  119,  156, &
                              77,  216,    6,  100,  184,   58,  137,   44, &
                             200,   94,  124,   21,  171,   73,  160,   32, &
                             220,  105,   62,  150,    9,  190,  114,   83, &
                             203,   41,  141,   91,  180,    2,  133,   55, &
                             211,  102,   29,  164,  152,   69,  188,   18, &
                             121,   80,  206,   47,  143,  108,   13,  193, &
                              89,  173,   39,  158,   64,  218,   24,  127, &
                             116,  182,   53,   97,  198,    4,  139,   75, &
                             169,   34,  213,   85,  131,   49,  162,   12, &
                             186,  106,   71,  205,   30,  147,  117,   60, &
                             175,   20,  222,   96,  135,   45,  154,   81, &
                             196,    7,  125,  166,   57,  109,  208,   27, &
                             148,   74,  179,   36,   99,  192,   10,  128, &
                              92,  215,   63,  155,   42,  174,  112,   15, &
                             201,   79,  138,   52,  185,    1,  122,  161, &
                              86,  219,   33,  103,  144,   66,  191,   23, &
                             151,   70,  204,   48,  120,  170,   17,  110, &
                             212,   84,   40,  165,  132,    5,  183,   93, &
                              59,  199,  115,   28,  149,   98,  217,   54, &
                             140,   14,  178,   76,  159,   43,  194,  104, &
                              68,  134,   22,  210,  126,   35,  172,   88, &
                             187,    3,  118,  157,   61,  221,   78,   31, &
                             146,  101,  197,   11,  136,   65,  181,   90, &
                             168,   46,  207,   19,  123,  107,  163,   50, &
                             202,   25,  129,   82,  189,   56,  142,    8, &
                             214,   95,  113,  153,   38,  176,   72 /)
      perm_data(49)%p  = (/    0,  113,  170,   38,  199,   68,  132,   16, &
                             184,   88,  148,   52,  218,   26,  122,   98, &
                             192,   60,  158,    6,  210,   81,  139,   44, &
                             175,  104,   31,  223,  118,   74,  163,   11, &
                             188,   93,  144,   49,  205,   64,  128,   20, &
                             179,  108,  154,   34,  214,   78,  136,    2, &
                             196,   90,  166,   56,  124,  221,   23,  101, &
                             160,   42,  182,   71,  142,   13,  207,   85, &
                             115,  194,   36,  151,   62,  173,    8,  110, &
                             225,   76,  130,   47,  202,   96,  156,   22, &
                             177,   57,  134,  212,   28,  105,  168,   67, &
                             120,    4,  201,   84,  186,   40,  146,   94, &
                             216,   18,  138,   54,  165,  111,   72,  191, &
                              14,  219,   87,  126,   33,  172,  150,   50, &
                             198,   79,    1,  153,  116,  209,   45,  102, &
                             181,   29,  133,   66,  226,   99,  161,   10, &
                             187,   59,  123,   82,  204,   25,  143,  107, &
                             176,   39,  213,   53,  140,   17,  164,   91, &
                             193,   70,  119,    7,  220,   95,  155,   43, &
                             180,   63,  129,   30,  203,  112,  147,   19, &
                             189,   77,  169,   48,  125,  215,    5,   89, &
                             159,   73,  197,   35,  135,  103,  224,   24, &
                             149,   61,  174,   83,  114,   12,  208,  100, &
                             183,   46,  141,   55,  195,   27,  157,  109, &
                              75,  217,    3,  167,  121,   65,  185,   37, &
                             131,  206,   86,   15,  152,   97,  222,   51, &
                             137,   32,  178,   92,  171,    9,  117,  200, &
                              69,  127,   41,  211,   80,  162,   21,  145, &
                             106,  190,   58 /)
      perm_data(50)%p  = (/    0,  114,  172,   38,  143,   69,  210,   16, &
                             157,   89,  195,   52,  124,   26,  221,   99, &
                             165,   61,  134,    6,  189,   82,  203,   45, &
                             129,  105,  181,   21,  217,   75,  149,   33, &
                             161,   94,  185,   10,  118,  226,   57,  109, &
                              66,  176,   30,  200,  138,   79,  152,    2, &
                             208,   86,  121,   43,  170,   50,  214,  102, &
                             145,   18,  191,   72,  132,   36,  223,   96, &
                             163,   12,  179,   63,  126,  197,   47,  111, &
                             154,   24,  206,   84,  140,    4,  183,   91, &
                             219,   55,  116,   40,  168,  106,  193,   28, &
                             147,   73,  228,   14,  136,   78,  174,   59, &
                             159,  100,  204,    8,  123,   53,  212,   92, &
                             155,   32,  187,   67,  130,   22,  215,  112, &
                             167,   42,  142,   81,  198,    1,  178,   88, &
                             119,   48,  224,   64,  151,   19,  190,  104, &
                             135,   35,  207,   76,  164,   13,  182,   98, &
                             127,   56,  220,   29,  148,  108,  199,   41, &
                             160,   70,  117,    7,  211,   87,  175,   60, &
                             141,   23,  227,   97,  171,   46,  131,  192, &
                              11,  113,  186,   71,  153,   34,  202,   83, &
                             122,   17,  216,   93,  158,   51,  177,   62, &
                             137,    3,  209,  103,  146,   37,  196,   77, &
                             125,   25,  222,  107,  166,   49,  180,    9, &
                             133,   80,  205,   65,  156,   31,  188,   95, &
                             115,  225,   20,  144,   58,  169,   74,  194, &
                               5,  120,   90,  213,   44,  150,  101,  173, &
                              27,  201,   54,  128,   85,  218,   15,  139, &
                              68,  184,   39,  162,  110 /)
      perm_data(51)%p  = (/    0,  116,  175,   39,  146,   70,  214,   17, &
                             131,  194,   58,   95,  165,   27,  225,   85, &
                             138,    7,  201,  104,  157,   50,  185,   76, &
                             121,   33,  220,   91,  171,   12,  206,   64, &
                             142,  109,   45,  190,  126,   22,  230,   81, &
                             160,   54,  180,  100,    3,  210,  134,   67, &
                             153,   36,  198,  112,   25,  218,   88,  167, &
                              60,  149,   14,  188,  118,   78,  227,   43, &
                             140,  177,    9,  106,  204,   73,  128,   48, &
                             212,   97,  162,   30,  182,   62,  151,    1, &
                             223,  114,   90,  192,   37,  136,  169,   20, &
                             123,  232,   56,   83,  196,   41,  155,  102, &
                             174,   16,  208,   72,  125,   52,  216,   98, &
                             145,    6,  184,   79,  159,   29,  202,  110, &
                              66,  143,  222,   23,  120,  172,   46,   93, &
                             199,   11,  133,  187,   69,  107,  228,   34, &
                             152,   55,  164,   86,  211,    4,  130,  101, &
                             179,   31,  217,   75,  139,   42,  191,  115, &
                              19,  168,   82,  226,   59,  148,   13,  195, &
                             111,   92,  161,   49,  207,   26,  132,  181, &
                              65,  124,  221,    5,   96,  156,   51,  203, &
                              77,  144,   35,  186,  105,  231,   18,  119, &
                             170,   61,  137,   40,  209,   87,  176,    8, &
                             150,   71,  215,   99,   28,  193,  122,   53, &
                             163,   84,  224,   15,  129,  178,   44,  113, &
                             200,   24,  154,   74,  213,   63,  135,    2, &
                             183,  103,  158,   47,  229,   89,  117,   32, &
                             197,  141,   10,  173,   80,  205,   57,  127, &
                              94,  219,   21,  166,   68,  147,   38,  189, &
                             108 /)
      perm_data(52)%p  = (/    0,  119,  179,   40,  209,   72,  139,   17, &
                             224,   93,  155,   54,  189,   28,  128,  167, &
                              82,  232,    7,  107,  197,   63,  147,   47, &
                             214,  100,  161,   22,  132,  202,   68,  112, &
                             183,   11,  228,   79,   37,  171,  123,   89, &
                             218,   32,  151,   58,  193,  104,  143,    3, &
                             237,   76,  174,   45,  159,  115,  206,   20, &
                              96,  187,   52,  136,  221,   14,  125,   85, &
                             200,   61,  165,   34,  230,  109,  145,    5, &
                             181,   74,  212,   49,  134,   98,  195,   26, &
                             157,   87,  235,   42,  121,  176,   13,  207, &
                              67,  149,  102,  169,   30,  222,   65,  130, &
                              91,  191,    1,  216,   56,  141,  114,  178, &
                              24,  226,   78,  117,   39,  185,  153,   51, &
                             204,   84,    9,  163,  234,  105,   70,  138, &
                              19,  199,  126,   44,  213,   95,  166,   31, &
                             173,   81,  227,   59,  144,    8,  190,  111, &
                             131,   36,  219,   92,  158,   16,  196,   71, &
                             152,  108,  238,   48,  122,   25,  184,  170, &
                              62,  210,    4,  118,  148,   77,  223,   55, &
                             180,   97,   29,  203,  135,   86,  162,   15, &
                             231,   66,  127,  192,   41,  103,  208,   21, &
                             154,   90,  175,   50,  217,  113,    2,  142, &
                             233,   73,  133,   35,  186,   99,  168,   43, &
                             201,   60,  120,  220,   10,  150,   80,  182, &
                              27,  140,  229,   69,  106,  164,   18,  198, &
                              88,   53,  211,  124,   38,  172,  110,  236, &
                               6,  146,   75,  188,   57,  156,   94,  215, &
                              23,  129,  194,   33,  101,  177,   64,  225, &
                              12,  137,  116,  205,   46,  160,   83 /)
      perm_data(53)%p  = (/    0,  120,  181,   40,  151,   72,  221,   17, &
                             136,  201,   84,   55,  171,  102,  232,    8, &
                             128,  191,   47,   95,  211,   29,  159,  110, &
                              65,  227,  144,   22,  176,   79,  197,   35, &
                             132,  215,   60,  114,  164,    3,  238,   90, &
                             148,   50,  186,   76,  123,  206,   13,  167, &
                              98,   32,  224,  106,  155,   43,  194,   68, &
                             140,   11,  235,   88,  179,   57,  208,  117, &
                              24,  161,  126,   70,  218,    5,  184,  100, &
                             142,   38,  230,   82,  173,   27,  199,  108, &
                              53,  153,  213,   19,  131,   92,  189,   62, &
                             240,   45,  138,  113,  169,    1,  204,   77, &
                             157,   34,  223,   94,  122,   16,  193,  146, &
                              64,  228,   51,  175,   86,  134,   25,  210, &
                             104,  165,   10,  202,   74,  118,  234,   42, &
                             150,   59,  183,   97,  188,   20,  129,  219, &
                              37,  111,  162,   69,  216,    6,  143,   83, &
                             196,   48,  172,  105,  237,   30,  125,   80, &
                             180,   14,  225,  137,   56,  156,   89,  205, &
                              26,  116,  190,   66,  160,    4,  231,  101, &
                             147,   44,  212,   73,  177,   33,  127,  200, &
                              54,  112,  236,   12,  152,   91,  168,   61, &
                             217,   21,  135,  185,   85,  107,  207,   39, &
                             141,    7,  226,   78,  166,  119,   49,  195, &
                              96,  178,   18,  239,   67,  133,   31,  192, &
                             121,  154,   46,  220,   75,  103,  170,    2, &
                             209,   87,  145,   28,  229,   63,  158,  115, &
                             187,   15,  130,  214,   52,   93,  182,   36, &
                             233,   81,  139,    9,  198,  109,  163,   58, &
                             203,   41,  124,  174,   23,  222,   99,   71, &
                             149 /)
      perm_data(54)%p  = (/    0,  125,  188,   42,  220,   75,  146,   18, &
                             204,   98,  163,   57,  241,   29,  134,  176, &
                              86,  229,    7,  112,  169,   66,  211,   49, &
                             152,  105,  246,   23,  193,   91,  130,   36, &
                             216,  118,  181,   11,  157,   71,  234,   80, &
                             141,   46,  200,  108,  225,    3,  172,   61, &
                             196,   95,  138,   32,  249,  121,   53,  208, &
                             155,   15,  184,   83,  236,   64,  128,   26, &
                             190,  102,  222,   39,  161,  115,  167,    9, &
                             239,   77,  144,   55,  213,   93,  179,   21, &
                             231,  110,   69,  150,  202,   34,  136,  244, &
                               1,  123,  174,   73,  198,   45,  100,  218, &
                              51,  159,   88,  227,   16,  148,  186,   82, &
                             132,   27,  247,  114,  192,   40,  165,   62, &
                             210,    6,  140,  232,   96,   68,  178,  119, &
                              20,  215,  104,  170,   48,  238,   85,  153, &
                              13,  205,  126,   58,  195,   33,  243,  107, &
                             143,   76,  183,    5,  223,   90,  160,   43, &
                             207,  122,   30,  228,  133,   60,  175,   99, &
                             199,   22,  149,  250,   54,  111,  166,   12, &
                             219,   79,  137,   70,  189,   37,  235,  116, &
                             156,    2,  203,   89,  180,   50,  240,   94, &
                             129,   25,  212,   65,  164,  145,   38,  224, &
                             103,  185,   17,  124,  245,   74,  171,   44, &
                             194,   84,  139,   10,  217,  109,  154,   56, &
                             233,   28,  187,   97,  131,  209,    8,  162, &
                              67,  242,   78,  117,  197,   31,  147,   52, &
                             226,  106,  177,   19,  206,   87,  142,   41, &
                             248,  120,   63,  173,    4,  221,  101,  158, &
                              59,  201,   24,  182,  127,  237,   72,   92, &
                             151,   14,  214,  113,  191,   35,  168,   81, &
                             230,   47,  135 /)
      perm_data(55)%p  = (/    0,  128,  193,   43,  161,   77,  236,   18, &
                             145,  214,   90,   58,  182,  109,  248,    9, &
                             137,  204,   36,  101,  225,   67,  169,  117, &
                              27,  242,  153,   52,  188,   84,  218,    4, &
                             133,  175,   72,  253,   32,  122,  200,   96, &
                             157,   22,  229,   63,  178,  106,  210,   46, &
                             142,   81,  239,   13,  166,  114,  221,   40, &
                             149,   92,  197,    7,  251,   70,  172,  124, &
                              54,  208,  103,  232,   25,  140,  185,   49, &
                             159,   86,  245,   15,  191,  112,   61,  223, &
                             130,   30,  202,   94,  164,    2,  256,  120, &
                              74,  180,   39,  216,  147,   65,  234,   99, &
                              20,  195,  135,   79,  227,   34,  155,  173, &
                              56,  244,  110,   11,  206,  126,   88,  186, &
                              45,  238,  139,   23,  167,  104,  212,   59, &
                             151,    5,  250,  118,   76,  198,   48,  220, &
                             132,   83,  177,   28,  231,   98,  162,   16, &
                             190,  115,  247,   51,  146,   68,  209,   35, &
                             170,  107,  228,    1,  152,   87,  254,   62, &
                             183,  125,   31,  203,   93,  217,   14,  143, &
                             160,   71,  240,   42,  189,  119,   55,  224, &
                             100,  136,   10,  199,  174,   78,  243,   24, &
                             129,  156,   44,  235,   89,  181,   37,  213, &
                             111,   66,  194,    6,  255,  134,   82,  165, &
                              53,  219,  121,   19,  205,  148,   97,  237, &
                              29,  168,   73,  184,  105,   12,  249,  141, &
                              60,  211,  113,   41,  192,  154,   75,  230, &
                               3,  131,  222,   50,  171,   95,  246,   26, &
                             144,  108,  196,   64,  179,   21,  233,   85, &
                             127,  158,   38,  215,   80,  252,    8,  150, &
                             116,  201,   57,  176,   47,  226,  102,  138, &
                              17,  207,   91,  187,   33,  241,  123,   69, &
                             163 /)
      perm_data(56)%p  = (/    0,  132,   66,  219,   33,  184,  110,  244, &
                              16,  161,   92,  203,   55,  233,  122,   79, &
                             173,    8,  256,  145,   46,  194,  102,  154, &
                              27,  226,   86,  209,  127,   41,  250,   72, &
                             168,  139,    4,  214,  106,  188,   59,  239, &
                              23,  151,  116,  260,   51,  178,   83,  199, &
                              19,  164,   97,  229,   63,  136,  222,   36, &
                             181,  113,   11,  247,  142,   75,  206,   44, &
                             191,   99,  253,   29,  157,  120,  216,   69, &
                             148,    2,  236,   89,  175,   53,  197,  125, &
                              25,  258,  104,  166,   61,  224,   81,  186, &
                              13,  241,  130,   39,  159,  211,   94,  118, &
                              32,  235,  144,   70,  201,    7,  251,  109, &
                             171,   49,  192,   87,  150,  230,   20,  134, &
                              76,  262,   43,  180,  124,  212,   14,  162, &
                              95,  221,   57,  196,   65,  138,  245,    5, &
                             114,  176,   37,  238,  101,  155,   78,  207, &
                              30,  254,  129,   52,  185,   90,  218,   17, &
                             169,  112,  231,   47,  147,   73,  248,   10, &
                             189,  135,  105,  204,   35,  227,   84,  158, &
                              60,  259,  121,   22,  179,  141,  213,    1, &
                              98,  242,   67,  167,   48,  200,  126,   82, &
                             234,   26,  172,  152,   56,  255,  108,  195, &
                              15,  140,  217,   71,  117,  225,   34,  182, &
                              91,  160,    6,  246,   96,  205,   42,  146, &
                             240,   62,  131,   24,  190,  111,  261,   77, &
                             170,   40,  210,  103,  153,    9,  228,   85, &
                             187,   54,  249,  123,   28,  177,  137,  220, &
                              64,   18,  202,  119,  163,   74,  252,   45, &
                             198,  100,  149,    3,  237,   88,  215,   50, &
                             165,  128,   31,  257,  115,  183,   68,  223, &
                              12,  143,  193,   80,  232,   38,  133,  174, &
                              93,  243,   21,  107,  208,   58,  156 /)
      perm_data(57)%p  = (/    0,  134,  202,   45,  168,   81,  247,   19, &
                             185,  105,  229,   61,  146,   31,  259,  117, &
                             177,   71,  217,    7,  155,   96,  238,   53, &
                             196,  124,   36,  264,  110,  162,   13,  213, &
                              88,  224,   75,  150,  191,   25,  251,  100, &
                             138,   49,  234,  128,    3,  206,  173,   66, &
                             255,   85,  159,   40,  210,  114,  182,   22, &
                             243,   92,  141,   57,  226,  121,   15,  267, &
                             170,   68,  194,   42,  220,  107,  148,   28, &
                             241,  131,   78,  199,    9,  257,  157,   90, &
                             180,   55,  215,  102,   34,  236,  136,  165, &
                               5,  249,   73,  188,  115,   51,  207,  126, &
                             262,   24,  152,   83,  200,   63,  231,   38, &
                             175,  111,  222,   11,  143,  253,   94,   59, &
                             184,  130,   18,  244,  163,   79,  204,   46, &
                             171,  103,  266,    1,  144,  218,   69,  120, &
                             192,   32,  233,   98,  154,   48,  246,   87, &
                             187,   21,  211,  123,  139,  260,   29,   76, &
                             178,  227,   58,  113,  166,   10,  239,  133, &
                              65,  208,   97,  256,   37,  160,  195,   16, &
                             147,  223,   84,  108,  268,   43,  176,   54, &
                             198,  119,    4,  235,  137,   91,  214,   27, &
                             181,   72,  250,  127,  156,   41,  230,   80, &
                             189,   14,  261,  106,  151,   62,  203,   99, &
                             169,   23,  242,  122,   50,  219,  142,    6, &
                             252,   93,  183,   67,  209,   35,  164,  132, &
                             240,   56,  172,   86,  263,   17,  149,  112, &
                             221,   33,  193,  104,  228,   47,  158,   74, &
                             248,    2,  190,  118,  135,  212,   60,  258, &
                              26,  145,   89,  201,   77,  174,   12,  237, &
                             116,  179,   44,  265,  101,  161,   30,  225, &
                              70,  197,  125,    8,  245,  129,   82,  205, &
                              52,  167,  232,   39,  140,  109,  254,   20, &
                             186,   95,  216,   64,  153 /)
      perm_data(58)%p  = (/    0,  135,  203,   45,  237,   81,  158,   19, &
                             254,  105,  176,   62,  215,   31,  145,  190, &
                              93,  263,    8,  121,  224,   71,  166,  112, &
                             243,   38,  182,   55,  150,  229,   14,  127, &
                             207,   86,  267,   50,  139,   99,  196,   24, &
                             247,   76,  171,  117,  219,    3,  186,   66, &
                             257,  108,  154,   35,  211,   89,  233,   27, &
                             162,  131,  199,   57,  251,   11,  142,   97, &
                             227,   69,  179,   42,  269,  124,  168,   21, &
                             209,  102,  192,   60,  241,   79,  148,    5, &
                             259,  119,  174,   47,  221,   91,  156,   33, &
                             239,  129,  194,   16,  110,  249,   74,  184, &
                              52,  217,  137,   29,  262,   95,  163,   64, &
                             205,  115,  231,    1,  152,   83,  245,   40, &
                             180,  133,  201,   22,  265,   85,  144,   54, &
                             213,  106,  172,   12,  235,  122,   68,  225, &
                             160,   37,  255,  100,  188,    9,  141,  198, &
                              73,  252,   48,  126,  177,   26,  222,   90, &
                             165,  270,   58,  113,  206,   17,  149,  236, &
                              78,  104,  191,   41,  244,  132,    6,  214, &
                              87,  169,   61,  260,  138,   32,  195,  116, &
                             230,   44,  157,   77,  248,   15,  183,  123, &
                             218,   65,  153,   96,  264,   23,  187,  109, &
                             210,   49,  161,    2,  240,  130,   82,  228, &
                              53,  175,  146,   30,  258,  101,  202,   70, &
                             223,   10,  167,  118,  268,   39,  140,  197, &
                              84,  234,   25,  111,  181,   63,  250,   94, &
                             155,   18,  212,  134,  242,   46,  173,   75, &
                             204,    4,  147,  256,   98,   56,  189,  125, &
                             226,   34,  164,   88,  266,   36,  193,  114, &
                              67,  238,  136,   13,  216,  107,  178,   51, &
                             253,  128,   20,  208,  151,   80,  232,   59, &
                             170,    7,  261,  103,  159,   92,  200,   43, &
                             246,  120,   28,  185,  220,   72,  143 /)
      perm_data(59)%p  = (/    0,  138,  208,   46,  173,   83,  254,   20, &
                             190,  108,  235,   63,  150,   32,  267,  120, &
                             199,   73,  162,    7,  242,   99,  220,   54, &
                             156,  127,  261,   26,  183,   91,  226,   40, &
                             143,  248,   77,  178,   12,  213,  113,  273, &
                              59,  132,  195,   16,  167,   95,  232,   68, &
                             216,   37,  147,  258,  104,    3,  203,  123, &
                             245,   51,  170,   87,  270,  116,   29,  187, &
                             154,   70,  229,   43,  206,  134,   93,  252, &
                              10,  180,  140,  238,   56,  106,  222,   23, &
                             164,  275,   79,  125,  193,   34,  211,   65, &
                             159,  263,    5,  111,  185,   85,  240,   48, &
                             151,  224,   18,  130,  256,   97,  175,   61, &
                             201,   30,  265,  118,  145,   75,  218,   14, &
                             197,  102,  247,   45,  168,  136,  234,   38, &
                             177,   81,  271,    1,  157,  110,  214,   67, &
                             250,   89,  189,   24,  142,  230,   53,  165, &
                             121,  260,   21,  204,   92,  129,  237,   49, &
                             182,   72,  276,    8,  153,  209,  101,   58, &
                             225,  115,  172,   33,  253,   82,  192,   13, &
                             148,  243,  107,  135,   41,  266,  196,   64, &
                             161,   27,  219,  124,  228,   76,  179,    4, &
                             259,   98,  141,   52,  210,  169,   36,  269, &
                              88,  200,  114,   17,  241,  131,   69,  217, &
                             158,   44,  249,  103,  186,    9,  233,   84, &
                             149,  188,   57,  272,   25,  128,  205,   96, &
                             163,   39,  255,  119,  223,    2,  174,   78, &
                             244,   62,  144,  198,   31,  264,  109,  137, &
                              71,  215,   19,  181,  239,   90,  155,   50, &
                             274,  117,  171,   11,  227,   80,  194,   47, &
                             251,  126,  100,  207,   22,  160,  262,   60, &
                             139,  184,   35,  231,   94,  146,    6,  246, &
                             112,  202,   66,  221,   42,  166,  268,   86, &
                             122,   15,  212,  152,   74,  257,  133,   28, &
                             191,  176,   55,  236,  105 /)
      perm_data(60)%p  = (/    0,  140,  211,   47,  176,   84,  258,   20, &
                             158,  234,   98,   64,  199,  119,  271,    9, &
                             167,   74,  242,  111,   35,  221,  147,  189, &
                              41,  264,   92,  130,  206,   15,  248,   59, &
                             162,  106,  227,   28,  183,  125,  277,   54, &
                             151,   79,  238,    3,  195,  134,  254,   69, &
                             173,   32,  216,  102,  267,   50,  143,  192, &
                              88,  224,   12,  121,  251,   71,  170,   25, &
                             209,  115,  275,   44,  155,  185,   94,  232, &
                               6,  137,  245,   62,  179,  104,  261,   37, &
                             202,   82,  149,  218,   22,  127,  279,   57, &
                             164,  109,  229,   17,  197,   77,  256,  117, &
                              40,  181,  214,   87,  145,    1,  269,  160, &
                              66,  240,   99,  190,   30,  236,  132,   52, &
                             204,  123,  263,   13,  168,   90,  223,   48, &
                             153,  250,   73,  138,  201,   24,  273,   96, &
                             175,   34,  230,  113,   61,  212,  142,    7, &
                             259,  108,  186,   76,  244,   43,  165,  129, &
                             280,   18,  193,   85,  219,   56,  156,  247, &
                              27,  124,  178,  101,  266,    4,  207,   80, &
                             152,  233,   53,  135,  198,   67,  253,   31, &
                             171,  114,  226,   11,  272,   95,  146,  184, &
                              46,  215,   89,  241,   38,  131,  172,   70, &
                             262,  110,   16,  208,  159,  237,   60,  120, &
                             276,   21,  188,  103,  163,   49,  249,   81, &
                             203,    2,  222,  139,  118,  257,   39,  180, &
                              75,  228,   97,  150,   26,  270,  141,   65, &
                             196,  213,   10,  166,  107,  265,   55,  191, &
                              86,  243,   33,  133,  220,   68,  157,  278, &
                               8,  126,  182,   93,  235,   42,  200,  116, &
                             252,   19,  148,   78,  231,   51,  174,  260, &
                             105,   23,  205,  136,  169,   63,  274,    5, &
                             187,  112,  225,   83,  154,   36,  246,  128, &
                             210,   45,  255,   91,  161,   14,  217,  100, &
                             177,   58,  268,  122,   29,  239,  144,   72, &
                             194 /)
      perm_data(61)%p  = (/    0,  141,  212,   47,  248,   85,  165,   20, &
                             230,  110,  184,   64,  271,   33,  152,  123, &
                             221,   75,  259,    7,  177,  101,  199,   55, &
                             277,  130,   93,  204,   25,  239,  146,   41, &
                             190,  116,  254,   12,  169,   80,  235,  105, &
                             159,  266,   37,  135,  215,   60,  194,    3, &
                             245,   90,  156,   69,  280,  120,  181,   28, &
                             225,   72,  207,  127,   50,  262,  148,   16, &
                             228,   98,  174,   53,  252,  113,  196,   10, &
                             273,  138,   82,  187,   39,  237,  107,  163, &
                              30,  218,  143,  264,   66,   95,  209,   18, &
                             243,  132,  171,   58,  275,   78,  179,    1, &
                             202,  118,  232,   44,  154,  256,   87,   23, &
                             192,  125,  250,   62,  161,  103,  223,   34, &
                             282,  136,   14,  205,   91,  175,  241,   49, &
                             150,   74,  268,  112,  188,    6,  217,   99, &
                             167,   43,  260,  129,  213,   27,  233,   70, &
                             145,  183,   56,  270,   84,  158,    9,  246, &
                             115,  200,   36,  226,  108,  140,  278,   22, &
                             172,   77,  220,   63,  195,  122,  257,   17, &
                             153,   94,  242,   46,  186,  102,  265,   31, &
                             166,  210,   67,  133,  251,    4,  178,   88, &
                             229,   52,  144,  276,  111,   40,  203,  126, &
                             236,   13,  162,   81,  261,   71,  197,  121, &
                             216,   24,  170,  272,   57,  137,   96,  224, &
                               5,  191,  149,   48,  253,  104,  240,   32, &
                             180,   86,  281,  119,   61,  208,  157,   19, &
                             247,  131,   76,  214,   38,  185,  267,   97, &
                             151,    8,  231,  114,  173,   54,  258,   68, &
                             198,  139,   26,  238,  106,  206,   42,  274, &
                              89,  164,    2,  222,  142,   79,  249,  128, &
                             182,   29,  269,   65,  160,  193,   15,  227, &
                             100,  124,  255,   51,  168,   83,  211,   21, &
                             279,  117,  155,   45,  234,   92,  189,   11, &
                             219,  134,  263,   59,  147,   73,  201,  176, &
                              35,  244,  109 /)
      perm_data(62)%p  = (/    0,  146,  220,   49,  183,   88,  269,   21, &
                             201,  114,  249,   67,  159,   34,  283,  127, &
                             211,   78,  171,    8,  256,  105,  233,   57, &
                             153,  240,   28,  190,  120,  278,   83,  137, &
                              14,  226,  177,   96,  289,   44,  197,  109, &
                             260,   61,  164,    3,  236,  133,  207,   72, &
                             266,   39,  149,  187,   93,  246,   24,  216, &
                             123,   64,  275,  142,   42,  223,  168,  100, &
                             286,   11,  180,   85,  252,  117,  195,   31, &
                             230,   74,  156,  272,   52,  135,  205,   17, &
                             262,  103,  173,   55,  242,  129,    5,  291, &
                             161,   91,  213,   69,  193,  112,  254,   26, &
                             218,  140,   46,  280,  151,   80,  203,   18, &
                             238,  119,  176,   37,  265,   98,  185,   59, &
                             245,  144,    1,  276,  107,  209,   76,  166, &
                             228,   33,  131,  285,   51,  189,   90,  234, &
                              13,  162,  258,  111,   65,  221,  148,   29, &
                             270,  125,  199,   71,  250,    9,  174,  138, &
                             288,   47,  182,   95,  225,   82,  210,   22, &
                             263,  122,  157,   41,  243,  102,  192,   58, &
                             281,  132,    6,  215,  167,   86,  255,   36, &
                             179,  115,  273,   63,  202,   19,  232,  143, &
                              99,  247,   53,  155,  292,   77,  170,   15, &
                             222,  126,  196,   43,  267,  106,  152,   70, &
                             239,    4,  206,  136,  279,   87,  184,   30, &
                             231,  113,  259,   50,  163,   81,  214,   25, &
                             284,  141,  118,  191,   38,  251,   94,  175, &
                              10,  264,  150,   66,  227,  108,  200,   56, &
                             274,  128,   20,  237,  169,   75,  217,   35, &
                             290,  145,   97,  188,    2,  248,  121,  181, &
                              62,  257,   89,  208,   45,  160,  271,   23, &
                             154,  229,  104,   73,  241,  134,   12,  282, &
                             178,   60,  204,  116,  219,   32,  261,   92, &
                             158,   48,  277,  130,  194,    7,  235,   84, &
                             172,  110,  253,   40,  198,  139,   68,  287, &
                              16,  212,  147,  101,  244,   54,  186,  124, &
                             268,   27,  165,  224,   79 /)
      perm_data(63)%p  = (/    0,  153,  230,   51,  269,   92,  179,   22, &
                             249,  119,  200,   70,  294,   35,  164,  133, &
                             259,   81,  213,    8,  284,  110,  188,   60, &
                             237,  141,  100,  301,   16,  206,  159,   45, &
                             264,  126,  221,   75,  183,   29,  279,  146, &
                             242,   56,  106,  289,    3,  194,  170,   88, &
                             253,  122,  224,   39,  275,   67,  173,  137, &
                             217,   19,  304,   96,  197,   48,  245,  115, &
                             156,  272,   12,  208,   84,  234,   64,  149, &
                             296,   32,  176,  129,  257,   78,  191,   25, &
                             282,  108,  227,   54,  166,  262,    5,  143, &
                             211,  102,  298,   73,  185,   41,  240,  131, &
                             267,   90,  161,   14,  232,  117,  287,   43, &
                             202,  139,  219,   62,  291,   27,  174,   98, &
                             251,  113,  193,    9,  277,  151,   79,  246, &
                              58,  204,  125,  306,   33,  168,  225,   86, &
                             181,    1,  270,  104,  238,   50,  155,  285, &
                              69,  198,  135,   23,  255,  121,  215,   38, &
                             300,  147,   94,  229,   65,  186,  261,   17, &
                             163,  111,  280,   47,  210,  132,  248,   11, &
                             177,   83,  293,   97,  220,   36,  190,  266, &
                              74,  144,  241,   26,  158,  303,  105,   57, &
                             205,  127,  273,    6,  171,  235,   77,  182, &
                             116,  288,   42,  216,   89,  256,   20,  152, &
                             196,   63,  276,  136,  101,  250,   30,  223, &
                             162,   53,  297,  123,  201,    2,  263,   87, &
                             169,  233,   68,  142,  292,   18,  187,  112, &
                             244,   46,  212,  128,  281,   34,  157,   93, &
                             260,   72,  207,  175,   10,  305,  118,  228, &
                              55,  148,  271,   80,  192,   24,  252,  138, &
                             103,  286,   40,  180,  222,   61,  239,  109, &
                             165,    7,  299,  134,  203,   49,  268,   85, &
                             184,   15,  247,  150,   95,  283,   71,  214, &
                             124,  231,   28,  295,  114,  167,   37,  258, &
                             154,   59,  199,  274,    4,  178,   91,  236, &
                              76,  218,  130,  302,   21,  145,  195,   52, &
                             265,  107,  226,   31,  172,  278,   82,  140, &
                             243,   13,  189,   99,  290,   66,  209,  120, &
                             254,   44,  160 /)
      perm_data(64)%p  = (/    0,  155,  233,   52,  272,   93,  181,   22, &
                             292,  121,  202,   71,  246,   36,  167,  135, &
                             282,   82,  216,    8,  257,  111,  191,   61, &
                             305,  143,   30,  225,  161,  102,  264,   45, &
                             209,  127,  297,   13,  186,   88,  241,  148, &
                              66,  277,  115,  221,   18,  252,  172,   76, &
                             301,   41,  196,  131,  236,    3,  176,   99, &
                             286,   57,  212,  140,  267,   48,  158,  106, &
                             260,   26,  229,  118,  309,   79,  193,   33, &
                             205,  151,  279,   68,  170,   10,  249,  108, &
                             290,   90,  199,   54,  239,  137,  179,   16, &
                             295,  124,  223,   73,  262,   38,  164,  218, &
                              96,  274,    5,  146,  244,   85,  184,   59, &
                             307,  129,  207,   28,  269,  113,  163,   43, &
                             254,  189,   80,  288,   20,  153,  231,  101, &
                             214,   50,  300,  123,  174,    1,  251,   94, &
                             200,   64,  283,  141,  227,   32,  157,  271, &
                              74,  133,  303,   23,  194,  105,  238,   55, &
                             182,  258,   12,  149,  285,   87,  210,  116, &
                              40,  243,  169,   69,  298,  126,  219,   15, &
                             265,   98,  178,   47,  234,  144,  293,   62, &
                             188,    6,  255,  110,  203,   84,  278,  136, &
                              34,  224,  160,   77,  310,  119,  197,   25, &
                             248,   92,  275,   44,  173,  213,    9,  289, &
                             132,  154,   65,  237,  107,  263,   29,  185, &
                             166,  304,   56,  122,  228,   81,  206,   19, &
                             270,  145,   97,  247,   49,  294,  162,    2, &
                             198,  128,  259,   72,  217,  103,  281,   37, &
                             177,  139,  232,   24,  306,   89,  190,   60, &
                             242,  150,  112,  276,   14,  208,   75,  253, &
                             156,   42,  299,  117,  183,   53,  222,  134, &
                             268,    7,  171,   91,  287,   67,  215,  165, &
                              31,  245,  114,  296,   83,  195,   17,  230, &
                             142,  261,   51,  180,  104,  308,   35,  204, &
                             125,  240,   63,  159,  280,    4,  192,  100, &
                             266,   78,  220,  138,   27,  291,  152,   58, &
                             235,  120,  201,   21,  284,   95,  175,  256, &
                              46,  168,  226,   86,  302,   11,  147,  211, &
                             109,  273,   39,  187,   70,  250,  130 /)

      ! Copy the first s pointers
      ! The pointers in permtable now point to the same
      ! storage locations as the ones in perm_data!
      !permtable = perm_data(1:s)
      do i=1,s
        permtable(i) = perm_data(i)
      end do

      ! Deallocate the permutations we don't need anymore
      do i=s+1,64
        deallocate(perm_data(i)%p)
      end do

    end function init_perm_bw_extended


    ! See [2], page 49.
    function init_perm_mcl(s) result (permtable)
      integer(kind=i4b), intent(in)           :: s
      type(permutation_pointer), dimension(s) :: permtable

      type(permutation_pointer), dimension(16) :: perm_data
      integer(kind=i4b) :: i

      do i=1,16
        allocate(perm_data(i)%p(allprimes(i)))
      end do

      perm_data(1)%p  = (/  0,  1 /)
      perm_data(2)%p  = (/  0,  1,  2 /)
      perm_data(3)%p  = (/  0,  4,  1,  2,  3 /)
      perm_data(4)%p  = (/  0,  1,  2,  3,  6,  5,  4 /)
      perm_data(5)%p  = (/  0,  1, 10,  9,  8,  2,  7,  6,  5,  4, &
                            3 /)
      perm_data(6)%p  = (/  0,  4, 11,  1,  2, 12, 10,  6,  7,  9, &
                            3,  8,  5 /)
      perm_data(7)%p  = (/  0, 16, 15, 13,  1, 11, 14,  9,  6,  3, &
                            2,  8,  4, 12,  5,  7, 10 /)
      perm_data(8)%p  = (/  0,  9, 14, 15,  7,  1,  2, 16, 18, 17, &
                            5, 12,  3, 11,  4,  6,  8, 13, 10 /)
      perm_data(9)%p  = (/  0, 18, 20, 17,  3, 15,  6,  9, 10, 14, &
                           21, 16, 19,  5,  4,  7,  8,  2, 11, 12, &
                           22, 13, 1 /)
      perm_data(10)%p = (/  0, 25, 18,  1, 22, 19, 11,  4, 23, 27, &
                            7, 14, 15,  3, 26, 20,  8, 24, 21, 10, &
                            2,  5,  6, 12, 16, 17, 13,  9, 28 /)
      perm_data(11)%p = (/  0, 13,  2,  7,  5, 26, 30,  3, 12, 27, &
                           24, 18, 28, 21,  4, 22, 14, 20,  8, 19, &
                           16, 25,  6, 23,  9, 10, 15, 17, 11, 29, &
                            1 /)
      perm_data(12)%p = (/  0,  5, 17, 15, 22, 30, 24,  8, 27, 28, &
                           36, 10,  3, 21, 33, 35,  6, 13, 18, 34, &
                           32, 31,  4, 12, 11, 29, 16, 19,  9,  7, &
                            2, 26, 25, 23,  1, 14, 20 /)
      perm_data(13)%p = (/  0, 40, 39, 29,  1, 11,  9, 13,  3,  6, &
                            7, 33, 10,  4, 23, 27,  2,  5, 26,  8, &
                           38, 34, 25, 16, 14, 35, 28, 15, 22, 32, &
                           18, 20, 21, 36, 31, 17, 12, 30, 24, 19, &
                           37 /)
      perm_data(14)%p = (/  0, 24,  9, 34, 28,  1, 18, 40, 38,  7, &
                           26,  5, 10, 42,  2, 13, 36, 32, 23,  6, &
                           27, 39,  8, 37, 19, 16, 22, 21,  3,  4, &
                           29, 17, 31, 35, 33, 25, 20, 15, 14, 11, &
                           12, 41, 30 /)
      perm_data(15)%p = (/  0, 23, 31, 46, 14, 34,  8, 10, 12, 24, &
                           29, 17, 39, 27, 21, 44, 18, 38, 25,  5, &
                            2, 40, 37,  6, 41, 30,  4, 33, 13,  7, &
                           42, 20, 26, 16,  3, 22, 45, 11, 15,  9, &
                            1, 43, 19, 32, 35, 36, 28 /)
      perm_data(16)%p = (/  0, 41, 10, 25, 29, 37, 48,  9, 11,  6, &
                           15,  5, 24, 14, 43, 30, 42, 46, 20, 16, &
                           47, 17, 52, 26, 35,  3, 45, 34,  7, 50, &
                           13, 33, 40, 12,  8, 38, 32, 23,  2, 27, &
                           28, 18, 36, 39,  1, 22, 49, 31,  4, 44, &
                           19, 51, 21 /)

      permtable = perm_data(1:s)

      do i=s+1,16
        deallocate(perm_data(i)%p)
      end do

    end function init_perm_mcl


    ! See [2], page 46.
    function init_perm_mcl_star(s) result (permtable)
      integer(kind=i4b), intent(in)           :: s
      type(permutation_pointer), dimension(s) :: permtable

      type(permutation_pointer), dimension(16) :: perm_data
      integer(kind=i4b)                        :: i

      do i=1,16
        allocate(perm_data(i)%p(allprimes(i)))
      end do

      perm_data(1)%p  = (/  0,  1/)
      perm_data(2)%p  = (/  0,  1,  2/)
      perm_data(3)%p  = (/  0,  3,  1,  2,  4/)
      perm_data(4)%p  = (/  0,  4,  5,  3,  2,  1,  6/)
      perm_data(5)%p  = (/  0,  2,  4,  7,  5,  9,  8,  3,  6,  1, &
                           10/)
      perm_data(6)%p  = (/  0,  4,  9, 10,  7,  3,  1,  6,  2,  5, &
                            8, 11, 12/)
      perm_data(7)%p  = (/  0,  8,  4,  5, 12,  9,  6, 15, 10, 14, &
                           13,  1, 16, 11,  3,  7,  2/)
      perm_data(8)%p  = (/  0, 11, 13,  7,  9,  6, 14,  3, 17,  2, &
                           10, 16, 12,  8, 15,  5,  4,  1, 18/)
      perm_data(9)%p  = (/  0, 13, 18, 16, 10, 19, 11, 14, 12,  7, &
                            5,  2, 17,  8,  3,  6,  4,  1, 21, 20, &
                           15,  9, 22/)
      perm_data(10)%p = (/  0, 16, 11, 10, 13,  7,  8, 19,  6, 20, &
                           12,  9, 15,  2,  3, 23, 21, 26, 24, 27, &
                           25, 22, 14, 18,  1,  4,  5, 17, 28/)
      perm_data(11)%p = (/  0, 13, 14, 17, 23, 26, 27,  5,  8, 19, &
                           29, 15, 25, 24, 28, 20,  7,  9, 22, 12, &
                            3,  1, 21, 16,  4,  2, 30,  6, 18, 10, &
                           11/)
      perm_data(12)%p = (/  0, 33, 13, 28, 14, 12, 24, 19, 34,  2, &
                            6, 22, 29, 25, 23, 11, 17, 32, 26,  3, &
                            5,  4, 15, 16, 10,  8, 18,  1,  7,  9, &
                           20, 27, 35, 36, 31, 21, 30/)
      perm_data(13)%p = (/  0, 20, 24, 21, 30, 12, 15, 34,  2, 31, &
                           13, 32, 18, 33, 10,  6, 25,  7,  3, 17, &
                           23, 38, 11, 19,  9, 14,  8, 35, 28,  5, &
                           27, 26,  4, 22, 16, 36, 37,  1, 29, 39, &
                           40/)
      perm_data(14)%p = (/  0, 32, 24, 31, 22, 20,  9, 39,  6, 15, &
                           29, 26, 13, 12, 23, 36, 10,  8, 17, 27, &
                           38, 21, 30, 28, 19, 33,  4,  3, 37, 11, &
                           14, 34, 25, 35, 42,  5, 18,  7,  1, 16, &
                           41, 2, 40/)
      perm_data(15)%p = (/  0, 20, 41, 30, 26, 29, 33, 13, 25, 42, &
                            7, 27, 18, 23, 44, 22, 37, 24,  6, 35, &
                            1,  8, 39, 17, 45, 16, 28, 38, 15, 11, &
                           34, 31, 36, 10,  2, 43,  5, 19,  4, 32, &
                           14,  3, 40, 46, 21,  9, 12/)
      perm_data(16)%p = (/  0, 43, 26, 41, 30, 48,  5, 27, 37,  9, &
                           29, 49,  7, 45,  4, 24, 52, 47, 23, 10, &
                           42, 21, 20, 18, 44, 22,  2, 11, 40, 31, &
                            8, 39, 32, 34, 28, 16, 36, 46, 14, 13, &
                           33,  6, 12, 19, 15, 38,  3, 50, 25,  1, &
                           35, 17, 51/)

      do i=1,s
        allocate(permtable(i)%p(allprimes(i)))
      end do

      permtable = perm_data(1:s)

      do i=s+1,16
        deallocate(perm_data(i)%p)
      end do

    end function init_perm_mcl_star


    ! Initialize the permutations from [4].
    !
    function init_perm_reverse(s) result (permtable)
      integer(kind=i4b), intent(in)           :: s
      type(permutation_pointer), dimension(s) :: permtable

      integer(kind=i4b), dimension(s) :: myprimes
      integer(kind=i4b)               :: i, j, b

      myprimes = primes(s)

      do i=1,s
        b = myprimes(i)
        allocate(permtable(i)%p(b))
        permtable(i)%p = (/ 0, (b-j, j=1,b-1) /)
      end do

    end function init_perm_reverse


    subroutine free_permutation_table(ptable)
      type(permutation_pointer), dimension(:), intent(inout) :: ptable

      integer(kind=i4b) :: i

      do i=1,size(ptable)
        if (associated(ptable(i)%p)) then
          deallocate(ptable(i)%p)
        end if
      end do

    end subroutine free_permutation_table

end module mod_permutation
